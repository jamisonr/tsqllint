#---------------------------------#
#      general configuration      #
#---------------------------------#

# Maximum number of concurrent jobs for the project
max_jobs: 2

#---------------------------------#
#    environment configuration    #
#---------------------------------#

environment:
  nodejs_version: "6"
  COVERALLS_REPO_TOKEN:  
    secure: rhkFWUMcufhM+G52drrNdm1g6CtCDfJjzlUY01jSYqBgzvX/3TKx8NeYBCiUSrKk

# Build worker image (VM template)
image: Visual Studio 2017

# scripts that are called at very beginning, before repo cloning
init:
  - git config --global core.autocrlf input

# fetch repository as zip archive
shallow_clone: true                 # default is "false"

# set clone depth
clone_depth: 5                      # clone entire repository history if not defined

#---------------------------------#
#       build configuration       #
#---------------------------------#

artifacts:
  - path: 'tsqllint*.tgz'

before_build:
  - nuget restore

build_script:
  - ./scripts/build.cmd

after_test:
  - cmd: packages\coveralls.io.1.4.1\tools\coveralls.net.exe --opencover .\coverage\coverage_results.xml -r %COVERALLS_REPO_TOKEN%

after_build:
  - cmd: npm pack
